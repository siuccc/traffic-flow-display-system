{% extends "base.html" %}

{% block title %}é¦–é¡µ - äº¤é€šæµé‡æ•°æ®å±•ç¤ºç³»ç»Ÿ{% endblock %}

{% block content %}
<!-- é¡µé¢ä¸»è¦å†…å®¹ -->
<div class="content-wrapper">
    <!-- æ•°æ®ç»Ÿè®¡ä¿¡æ¯ -->
    <div class="info-section">
        <h2>ğŸ“Š äº¤é€šæ•°æ®æ¦‚è§ˆ</h2>
    </div>

    <!-- äº¤é€šæ•°æ®è¡¨æ ¼ -->
    <div class="table-section">
        <h3>ğŸš— äº¤é€šè®°å½•åˆ—è¡¨</h3>
        
        {% if traffic_records %}
        <table class="traffic-table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>æ–¹å‘</th>
                    <th>é€šè¿‡æ—¶é—´</th>
                    <th>è½¦ç‰Œå·</th>
                </tr>
            </thead>
            <tbody>
                {% for record in traffic_records %}
                <tr>
                    <td class="center">{{ record.id }}</td>
                    <td class="center direction-{{ record.direction }}">{{ record.direction_text }}</td>
                    <td class="time">{{ record.formatted_time }}</td>
                    <td class="center plate">{{ record.plate }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        
        <!-- åˆ†é¡µå¯¼èˆª -->
        <div class="pagination">
            <!-- ä¸Šä¸€é¡µæŒ‰é’® -->
            {% if has_prev %}
                <a href="?page={{ prev_page }}" class="page-btn prev-btn">
                    â¬…ï¸ ä¸Šä¸€é¡µ
                </a>
            {% else %}
                <span class="page-btn prev-btn disabled">
                    â¬…ï¸ ä¸Šä¸€é¡µ
                </span>
            {% endif %}
            
            <!-- é¡µç æ˜¾ç¤º -->
            <div class="page-numbers">
                {% if current_page > 3 %}
                    <a href="?page=1" class="page-num">1</a>
                    {% if current_page > 4 %}
                        <span class="page-dots">...</span>
                    {% endif %}
                {% endif %}
                
                {% for page_num in range([current_page - 2, 1]|max, [current_page + 3, total_pages + 1]|min) %}
                    {% if page_num == current_page %}
                        <span class="page-num current">{{ page_num }}</span>
                    {% else %}
                        <a href="?page={{ page_num }}" class="page-num">{{ page_num }}</a>
                    {% endif %}
                {% endfor %}
                
                {% if current_page < total_pages - 2 %}
                    {% if current_page < total_pages - 3 %}
                        <span class="page-dots">...</span>
                    {% endif %}
                    <a href="?page={{ total_pages }}" class="page-num">{{ total_pages }}</a>
                {% endif %}
            </div>
            
            <!-- é¡µç è·³è½¬è¾“å…¥æ¡† -->
            <div class="page-jump">
                <span class="jump-label">è·³è½¬åˆ°</span>
                <input type="number" id="pageInput" class="page-input" min="1" max="{{ total_pages }}" placeholder="{{ current_page }}">
                <button onclick="jumpToPage()" class="jump-btn">GO</button>
            </div>
            
            <!-- ä¸‹ä¸€é¡µæŒ‰é’® -->
            {% if has_next %}
                <a href="?page={{ next_page }}" class="page-btn next-btn">
                    ä¸‹ä¸€é¡µ â¡ï¸
                </a>
            {% else %}
                <span class="page-btn next-btn disabled">
                    ä¸‹ä¸€é¡µ â¡ï¸
                </span>
            {% endif %}
        </div>
        
        {% else %}
        <div class="no-data">
            <p>âŒ æš‚æ— äº¤é€šæ•°æ®</p>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/pagination.js') }}"></script>
{% endblock %}
